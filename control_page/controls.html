<HTML>
    <HEAD><TITLE>DOOMBA</TITLE></HEAD>
    <BODY>
        <object type="application/x-shockwave-flash" data="http://www.justin.tv/widgets/live_embed_player.swf?channel=natthew" id="live_embed_player_flash" height="300" width="400" bgcolor="#000000"><param name="allowFullScreen" value="true"/><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="all" /><param name="movie" value="http://www.justin.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.justin.tv&channel=natthew&auto_play=false&start_volume=25" /></object><a href="http://www.justin.tv/natthew#r=-rid-&amp;s=em" class="trk" style="padding:2px 0px 4px; display:block; width:345px; font-weight:normal; font-size:10px; text-decoration:underline; text-align:center">Watch live video from natthew on www.justin.tv</a>
        <script>
            var server = '10.12.5.29:8081';

            function sendCommand(cmd) {
                req = XMLHttpRequest();
                req.open("POST", server + cmd, true);
                req.send();
            }

            function goForward() {
                sendCommand('/up/');
            }
            function goBackward() {
                sendCommand('/back');
            }
            function turnLeft() {
                sendCommand('/left');
            }
            function turnRight() {
                sendCommand('/right');
            }
            function forwardTurnRight() {
                return;
            }
            function forwardTurnLeft() {
                return;
            }

            function stop() {
                sendCommand('/stop');
            }

            function fire() {
                sendCommand('/fire');
            }

            /* key press state manager */
            var pressedKeys = {
                'up': false,
                'down': false,
                'left': false,
                'right': false
            };

            function manageKeyState() {
                if (pressedKeys['up']) {
                    if (pressedKeys['left']) {
                        forwardTurnLeft();
                    }
                    else if (pressedKeys['right']) {
                        forwardTurnRight();
                    }
                    else if (pressedKeys['down']) {
                        stop();
                    }
                    else {
                        goForward();
                    }
                }
                else if (pressedKeys['down']) {
                    goBackward();
                }
                else if (pressedKeys['left']) {
                    turnLeft();
                }
                else if (pressedKeys['right']) {
                    turnRight();
                }
                else {
                    stop();
                }
            }

            function toggleKey(keyCode, isPressed) {
                // Left
                if (keyCode == 37) {
                    pressedKeys['left'] = isPressed;
                }
                // Up
                else if (keyCode == 38) {
                    pressedKeys['up'] = isPressed;
                }
                // Right
                else if (keyCode == 39) {
                    pressedKeys['right'] = isPressed;
                }
                // Down
                else if (keyCode == 40) {
                    pressedKeys['down'] = isPressed;
                }
                else {
                    return false;
                }
                return true;
            }

            function pressKey(evt) {
                if (toggleKey(evt.keyCode, true)) {
                    manageKeyState();
                }
            }

            function releaseKey(evt) {
                if (toggleKey(evt.keyCode, false)) {
                    manageKeyState();
                }
            }

            document.onkeydown = pressKey;
            document.onkeyup = releaseKey;
        </script>
        <p>
        &nbsp; <a href='#' onclick='goForward()'>^</a>
        <br>
        <a href='#' onclick='goLeft()'> &lt;</a>
        &nbsp; <a href='#' onclick='goRight()'> &gt;</a>
        <br>
        &nbsp; <a href='#' onclick='goBackward()'>v</a>
        </p>
        <p> <a href='#' onclick='stop()'> STOP! </a> </p>
        <p> <a href='#' onclick='fire()'> FIRE! </a> </p>
    </BODY>
</HTML>
