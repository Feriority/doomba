<HTML>
    <HEAD><TITLE>DOOMBA</TITLE></HEAD>
    <BODY>
        <script>
            var server = '';

            function sendCommand(cmd) {
                var req = new XMLHttpRequest();
                req.open("GET", server + cmd, true);
                req.send();
            }

            function goForward() {
                sendCommand('/forward');
            }
            function goBackward() {
                sendCommand('/back');
            }
            function goLeft() {
                sendCommand('/left');
            }
            function goRight() {
                sendCommand('/right');
            }
            function forwardTurnRight() {
                return;
            }
            function forwardTurnLeft() {
                return;
            }

            function stop() {
                sendCommand('/stop');
            }

            function fire() {
                sendCommand('/fire');
            }

            /* key press state manager */
            var pressedKeys = {
                'up': false,
                'down': false,
                'left': false,
                'right': false
            };

            function manageKeyState() {
                if (pressedKeys['up']) {
                    if (pressedKeys['left']) {
                        forwardTurnLeft();
                    }
                    else if (pressedKeys['right']) {
                        forwardTurnRight();
                    }
                    else if (pressedKeys['down']) {
                        stop();
                    }
                    else {
                        goForward();
                    }
                }
                else if (pressedKeys['down']) {
                    goBackward();
                }
                else if (pressedKeys['left']) {
                    turnLeft();
                }
                else if (pressedKeys['right']) {
                    turnRight();
                }
                else {
                    stop();
                }
            }

            function toggleKey(keyCode, isPressed) {
                // Left / a
                if (keyCode == 37 || keyCode == 65) {
                    pressedKeys['left'] = isPressed;
                }
                // Up / w
                else if (keyCode == 38 || keyCode == 87) {
                    pressedKeys['up'] = isPressed;
                }
                // Right / d
                else if (keyCode == 39 || keyCode == 68) {
                    pressedKeys['right'] = isPressed;
                }
                // Down / s
                else if (keyCode == 40 || keyCode == 83) {
                    pressedKeys['down'] = isPressed;
                }
                else {
                    return false;
                }
                return true;
            }

            function pressKey(evt) {
                // Space is special; fire on press and move on
                if (evt.keyCode == 32) {
                    fire();
                    return;
                }
                if (toggleKey(evt.keyCode, true)) {
                    manageKeyState();
                }
            }

            function releaseKey(evt) {
                if (toggleKey(evt.keyCode, false)) {
                    manageKeyState();
                }
            }

            document.onkeydown = pressKey;
            document.onkeyup = releaseKey;
        </script>
        <p>
        &nbsp; <a href='#' onclick='goForward()'>^</a>
        <br>
        <a href='#' onclick='goLeft()'> &lt;</a>
        &nbsp; <a href='#' onclick='goRight()'> &gt;</a>
        <br>
        &nbsp; <a href='#' onclick='goBackward()'>v</a>
        </p>
        <p> <a href='#' onclick='stop()'> STOP! </a> </p>
        <p> <a href='#' onclick='fire()'> FIRE! </a> </p>
    </BODY>
</HTML>
